
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Module documentation &mdash; pybedtools v0.2.2dev documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2.2dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pybedtools v0.2.2dev documentation" href="index.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">pybedtools v0.2.2dev documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-documentation">
<h1>Module documentation<a class="headerlink" href="#module-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pybedtools">
<span id="pybedtools-module-level-functions"></span><h2><a class="reference internal" href="#module-pybedtools" title="pybedtools"><tt class="xref py py-mod docutils literal"><span class="pre">pybedtools</span></tt></a> module-level functions<a class="headerlink" href="#module-pybedtools" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pybedtools.data_dir">
<tt class="descclassname">pybedtools.</tt><tt class="descname">data_dir</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pybedtools.html#data_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pybedtools.data_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data directory that contains example files for tests and
documentation.</p>
</dd></dl>

<dl class="function">
<dt id="pybedtools.example_bed_fn">
<tt class="descclassname">pybedtools.</tt><tt class="descname">example_bed_fn</tt><big>(</big><em>bed</em><big>)</big><a class="reference internal" href="_modules/pybedtools.html#example_bed_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pybedtools.example_bed_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a bed file from the pybedtools examples directory.  Use
<a class="reference internal" href="#pybedtools.list_example_beds" title="pybedtools.list_example_beds"><tt class="xref py py-func docutils literal"><span class="pre">list_example_beds()</span></tt></a> to see a list of files that are included.</p>
</dd></dl>

<dl class="function">
<dt id="pybedtools.example_bedtool">
<tt class="descclassname">pybedtools.</tt><tt class="descname">example_bedtool</tt><big>(</big><em>fn</em><big>)</big><a class="reference internal" href="_modules/pybedtools.html#example_bedtool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pybedtools.example_bedtool" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a bedtool using a bed file from the pybedtools examples directory.
Use <a class="reference internal" href="#pybedtools.list_example_beds" title="pybedtools.list_example_beds"><tt class="xref py py-func docutils literal"><span class="pre">list_example_beds()</span></tt></a> to see a list of files that are included.</p>
</dd></dl>

<dl class="function">
<dt id="pybedtools.list_example_beds">
<tt class="descclassname">pybedtools.</tt><tt class="descname">list_example_beds</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/pybedtools.html#list_example_beds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pybedtools.list_example_beds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of bed files in the examples dir.  Choose one and pass
it to <tt class="xref py py-func docutils literal"><span class="pre">example_bed()</span></tt> to get the full path to an example BED file.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">choices</span> <span class="o">=</span> <span class="n">list_example_beds</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfn</span> <span class="o">=</span> <span class="n">example_bed</span><span class="p">(</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mybedtool</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="n">bedfn</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-methods-that-wrap-bedtools-programs">
<h2><tt class="xref py py-class docutils literal"><span class="pre">bedtool</span></tt> methods that wrap BEDTools programs<a class="headerlink" href="#bedtool-methods-that-wrap-bedtools-programs" title="Permalink to this headline">¶</a></h2>
<p>The following methods wrap <a href="#id1"><span class="problematic" id="id2">BEDTools_</span></a> programs.  This package is still in
development; the goal is to eventually support all <a href="#id3"><span class="problematic" id="id4">BEDTools_</span></a> programs.</p>
<div class="section" id="bedtool-intersect">
<h3><a class="reference internal" href="#pybedtools.bedtool.intersect" title="pybedtools.bedtool.intersect"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.intersect</span></tt></a><a class="headerlink" href="#bedtool-intersect" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.intersect">
<tt class="descclassname">bedtool.</tt><tt class="descname">intersect</tt><big>(</big><em>b=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.intersect" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pybedtools help:</em></p>
<blockquote>
<div><blockquote>
<div><p>Intersect with another BED file. If you want to use BAM as input, you
need to specify <em>abam='filename.bam'</em>.  Returns a new bedtool object.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># create new bedtool object</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># get overlaps with &quot;other.bed&quot;</span>
<span class="n">overlaps</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="s">&#39;other.bed&#39;</span><span class="p">)</span>

<span class="c"># use v=True to get the inverse, or those unique to in.bed</span>
<span class="n">unique_to_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="s">&#39;other.bed&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># features unique to &quot;other.bed&quot;</span>
<span class="n">unique_to_other</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;other.bed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method returns a new bedtool instance</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For convenience, the file this bedtool object points to is passed as &quot;-a&quot;</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method accepts either a bedtool or a file name as the first
unnamed argument</p>
</div>
</div></blockquote>
<p><em>Original BEDtools program help:</em></p>
<blockquote>
<div><p>Program: intersectBed (v2.10.0)
Author:  Aaron Quinlan (<a class="reference external" href="mailto:aaronquinlan&#37;&#52;&#48;gmail&#46;com">aaronquinlan<span>&#64;</span>gmail<span>&#46;</span>com</a>)
Summary: Report overlaps between two feature files.</p>
<p>Usage:   intersectBed [OPTIONS] -a &lt;bed/gff/vcf&gt; -b &lt;bed/gff/vcf&gt;</p>
<dl class="docutils">
<dt>Options: </dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-a<var>bam</var></span></kbd></td>
<td>The A input file is in BAM format.  Output will be BAM as well.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-u<var>bam</var></span></kbd></td>
<td>Write uncompressed BAM output. Default is to write compressed BAM.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-b<var>ed</var></span></kbd></td>
<td>When using BAM input (-abam), write output as BED. The default
is to write output in BAM when using -abam.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-w<var>a</var></span></kbd></td>
<td>Write the original entry in A for each overlap.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-w<var>b</var></span></kbd></td>
<td>Write the original entry in B for each overlap.
- Useful for knowing <strong>what</strong> A overlaps. Restricted by -f and -r.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-w<var>o</var></span></kbd></td>
<td><p class="first">Write the original A and B entries plus the number of base
pairs of overlap between the two features.
- Overlaps restricted by -f and -r.</p>
<blockquote class="last">
<div>Only A features with overlap are reported.</div></blockquote>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-w<var>ao</var></span></kbd></td>
<td><p class="first">Write the original A and B entries plus the number of base
pairs of overlap between the two features.
- Overlapping features restricted by -f and -r.</p>
<blockquote class="last">
<div>However, A features w/o overlap are also reported
with a NULL B feature and overlap = 0.</div></blockquote>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-u</span></kbd></td>
<td>Write the original A entry <strong>once</strong> if <strong>any</strong> overlaps found in B.
- In other words, just report the fact &gt;=1 hit was found.
- Overlaps restricted by -f and -r.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-c</span></kbd></td>
<td>For each entry in A, report the number of overlaps with B.
- Reports 0 for A entries that have no overlap with B.
- Overlaps restricted by -f and -r.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-v</span></kbd></td>
<td>Only report those entries in A that have <strong>no overlaps</strong> with B.
- Similar to &quot;grep -v&quot; (an homage).</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-f</span></kbd></td>
<td>Minimum overlap required as a fraction of A.
- Default is 1E-9 (i.e., 1bp).
- FLOAT (e.g. 0.50)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-r</span></kbd></td>
<td><p class="first">Require that the fraction overlap be reciprocal for A and B.
- In other words, if -f is 0.90 and -r is used, this requires</p>
<blockquote class="last">
<div>that B overlap 90% of A and A <strong>also</strong> overlaps 90% of B.</div></blockquote>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s</span></kbd></td>
<td>Force strandedness.  That is, only report hits in B that
overlap A on the same strand.
- By default, overlaps are reported without respect to strand.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s<var>plit</var></span></kbd></td>
<td>Treat &quot;split&quot; BAM or BED12 entries as distinct BED intervals.</td></tr>
</tbody>
</table>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="bedtool-merge">
<h3><a class="reference internal" href="#pybedtools.bedtool.merge" title="pybedtools.bedtool.merge"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.merge</span></tt></a><a class="headerlink" href="#bedtool-merge" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.merge">
<tt class="descclassname">bedtool.</tt><tt class="descname">merge</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.merge" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pybedtools help:</em></p>
<blockquote>
<div><blockquote>
<div><p>Merge overlapping features together. Returns a new bedtool object.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># allow merging of features 100 bp apart</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method returns a new bedtool instance</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For convenience, the file this bedtool object points to is passed as &quot;-i&quot;</p>
</div>
</div></blockquote>
<p><em>Original BEDtools program help:</em></p>
<blockquote>
<div><p>Program: mergeBed (v2.10.0)
Author:  Aaron Quinlan (<a class="reference external" href="mailto:aaronquinlan&#37;&#52;&#48;gmail&#46;com">aaronquinlan<span>&#64;</span>gmail<span>&#46;</span>com</a>)
Summary: Merges overlapping BED/GFF/VCF entries into a single interval.</p>
<p>Usage:   mergeBed [OPTIONS] -i &lt;bed/gff/vcf&gt;</p>
<dl class="docutils">
<dt>Options: </dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-s</span></kbd></td>
<td>Force strandedness.  That is, only merge features
that are the same strand.
- By default, merging is done without respect to strand.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-n</span></kbd></td>
<td>Report the number of BED entries that were merged.
- Note: &quot;1&quot; is reported if no merging occurred.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-d</span></kbd></td>
<td>Maximum distance between features allowed for features
to be merged.
- Def. 0. That is, overlapping &amp; book-ended features are merged.
- (INTEGER)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-n<var>ms</var></span></kbd></td>
<td>Report the names of the merged features separated by semicolons.</td></tr>
</tbody>
</table>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="bedtool-subtract">
<h3><a class="reference internal" href="#pybedtools.bedtool.subtract" title="pybedtools.bedtool.subtract"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.subtract</span></tt></a><a class="headerlink" href="#bedtool-subtract" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.subtract">
<tt class="descclassname">bedtool.</tt><tt class="descname">subtract</tt><big>(</big><em>other</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.subtract" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pybedtools help:</em></p>
<blockquote>
<div><blockquote>
<div><p>Subtracts from another BED file and returns a new bedtool object.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># do a &quot;stranded&quot; subtraction</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="s">&#39;other.bed&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Require 50% of features in a to overlap</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="s">&#39;other.bed&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method returns a new bedtool instance</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method accepts either a bedtool or a file name as the first
unnamed argument</p>
</div>
</div></blockquote>
<p><em>Original BEDtools program help:</em></p>
<blockquote>
<div><p>Program: subtractBed (v2.10.0)
Author:  Aaron Quinlan (<a class="reference external" href="mailto:aaronquinlan&#37;&#52;&#48;gmail&#46;com">aaronquinlan<span>&#64;</span>gmail<span>&#46;</span>com</a>)
Summary: Removes the portion(s) of an interval that is overlapped</p>
<blockquote>
<div>by another feature(s).</div></blockquote>
<p>Usage:   subtractBed [OPTIONS] -a &lt;bed/gff/vcf&gt; -b &lt;bed/gff/vcf&gt;</p>
<dl class="docutils">
<dt>Options: </dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-f</span></kbd></td>
<td>Minimum overlap required as a fraction of A.
- Default is 1E-9 (i.e., 1bp).
- (FLOAT) (e.g. 0.50)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s</span></kbd></td>
<td>Force strandedness.  That is, only report hits in B that
overlap A on the same strand.
- By default, overlaps are reported without respect to strand.</td></tr>
</tbody>
</table>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="bedtool-sequence">
<h3><a class="reference internal" href="#pybedtools.bedtool.sequence" title="pybedtools.bedtool.sequence"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.sequence</span></tt></a><a class="headerlink" href="#bedtool-sequence" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.sequence">
<tt class="descclassname">bedtool.</tt><tt class="descname">sequence</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.sequence" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pybedtools help:</em></p>
<blockquote>
<div><blockquote>
<div><p>Wraps <tt class="docutils literal"><span class="pre">fastaFromBed</span></tt>.  <em>fi</em> is passed in by the user; <em>bed</em> is
automatically passed in as the bedfile of this object; <em>fo</em> by default
is a temp file.  Use save_seqs() to save as a file.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="n">fi</span><span class="o">=</span><span class="s">&#39;genome.fa&#39;</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">print_sequence</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method returns a new bedtool instance</p>
</div>
</div></blockquote>
<p><em>Original BEDtools program help:</em></p>
<blockquote>
<div><p>Program: fastaFromBed (v2.10.0)
Author:  Aaron Quinlan (<a class="reference external" href="mailto:aaronquinlan&#37;&#52;&#48;gmail&#46;com">aaronquinlan<span>&#64;</span>gmail<span>&#46;</span>com</a>)
Summary: Extract DNA sequences into a fasta file based on feature coordinates.</p>
<p>Usage:   fastaFromBed [OPTIONS] -fi &lt;fasta&gt; -bed &lt;bed/gff/vcf&gt; -fo &lt;fasta&gt;</p>
<dl class="docutils">
<dt>Options: </dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-f<var>i</var></span></kbd></td>
<td>Input FASTA file</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-b<var>ed</var></span></kbd></td>
<td>BED/GFF/VCF file of ranges to extract from -fi</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-f<var>o</var></span></kbd></td>
<td>Output file (can be FASTA or TAB-delimited)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-n<var>ame</var></span></kbd></td>
<td>Use the name field for the FASTA header</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-t<var>ab</var></span></kbd></td>
<td>Write output in TAB delimited format.
- Default is FASTA format.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s</span></kbd></td>
<td>Force strandedness. If the feature occupies the antisense strand,
the sequence will be reverse complemented.
- By default, strand information is ignored.</td></tr>
</tbody>
</table>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="bedtool-closest">
<h3><a class="reference internal" href="#pybedtools.bedtool.closest" title="pybedtools.bedtool.closest"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.closest</span></tt></a><a class="headerlink" href="#bedtool-closest" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.closest">
<tt class="descclassname">bedtool.</tt><tt class="descname">closest</tt><big>(</big><em>other</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.closest" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pybedtools help:</em></p>
<blockquote>
<div><blockquote>
<div><p>Return a new bedtool object containing closest features in <em>other</em>.  Note
that the resulting file is no longer a valid BED format; use the
special &quot;_closest&quot; methods to work with the resulting file.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># get the closest feature in &#39;other.bed&#39; on the same strand</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">closest</span><span class="p">(</span><span class="s">&#39;other.bed&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method returns a new bedtool instance</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For convenience, the file this bedtool object points to is passed as &quot;-a&quot;</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method accepts either a bedtool or a file name as the first
unnamed argument</p>
</div>
</div></blockquote>
<p><em>Original BEDtools program help:</em></p>
<blockquote>
<div><p>Program: closestBed (v2.10.0)
Authors: Aaron Quinlan (<a class="reference external" href="mailto:aaronquinlan&#37;&#52;&#48;gmail&#46;com">aaronquinlan<span>&#64;</span>gmail<span>&#46;</span>com</a>)</p>
<blockquote>
<div>Erik Arner, Riken</div></blockquote>
<dl class="docutils">
<dt>Summary: For each feature in A, finds the closest </dt>
<dd>feature (upstream or downstream) in B.</dd>
</dl>
<p>Usage:   closestBed [OPTIONS] -a &lt;bed/gff/vcf&gt; -b &lt;bed/gff/vcf&gt;</p>
<dl class="docutils">
<dt>Options: </dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-s</span></kbd></td>
<td>Force strandedness.  That is, find the closest feature in B
that overlaps A on the same strand.
- By default, overlaps are reported without respect to strand.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-d</span></kbd></td>
<td>In addition to the closest feature in B, 
report its distance to A as an extra column.
- The reported distance for overlapping features will be 0.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-t</span></kbd></td>
<td>How ties for closest feature are handled.  This occurs when two
features in B have exactly the same overlap with A.
By default, all such features in B are reported.
Here are all the options:
- &quot;all&quot;  Report all ties (default).
- &quot;first&quot;  Report the first tie that occurred in the B file.
- &quot;last&quot;  Report the last tie that occurred in the B file.</td></tr>
</tbody>
</table>
</dd>
<dt>Notes: </dt>
<dd>Reports &quot;none&quot; for chrom and &quot;-1&quot; for all other fields when a feature
is not found in B on the same chromosome as the feature in A.
E.g. none       -1      -1</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="bedtool-window">
<h3><a class="reference internal" href="#pybedtools.bedtool.window" title="pybedtools.bedtool.window"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.window</span></tt></a><a class="headerlink" href="#bedtool-window" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.window">
<tt class="descclassname">bedtool.</tt><tt class="descname">window</tt><big>(</big><em>other</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.window" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pybedtools help:</em></p>
<blockquote>
<div><blockquote>
<div><p>Intersect with a window.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># Consider features up to 500 bp away as overlaps</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For convenience, the file this bedtool object points to is passed as &quot;-a&quot;</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method accepts either a bedtool or a file name as the first
unnamed argument</p>
</div>
</div></blockquote>
<p><em>Original BEDtools program help:</em></p>
<blockquote>
<div><p>Program: windowBed (v2.10.0)
Author:  Aaron Quinlan (<a class="reference external" href="mailto:aaronquinlan&#37;&#52;&#48;gmail&#46;com">aaronquinlan<span>&#64;</span>gmail<span>&#46;</span>com</a>)
Summary: Examines a &quot;window&quot; around each feature in A and</p>
<blockquote>
<div>reports all features in B that overlap the window. For each
overlap the entire entry in A and B are reported.</div></blockquote>
<p>Usage:   windowBed [OPTIONS] -a &lt;bed/gff/vcf&gt; -b &lt;bed/gff/vcf&gt;</p>
<dl class="docutils">
<dt>Options: </dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-a<var>bam</var></span></kbd></td>
<td>The A input file is in BAM format.  Output will be BAM as well.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-u<var>bam</var></span></kbd></td>
<td>Write uncompressed BAM output. Default is to write compressed BAM.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-b<var>ed</var></span></kbd></td>
<td>When using BAM input (-abam), write output as BED. The default
is to write output in BAM when using -abam.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-w</span></kbd></td>
<td>Base pairs added upstream and downstream of each entry
in A when searching for overlaps in B.
- Creates symterical &quot;windows&quot; around A.
- Default is 1000 bp.
- (INTEGER)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-l</span></kbd></td>
<td>Base pairs added upstream (left of) of each entry
in A when searching for overlaps in B.
- Allows one to define assymterical &quot;windows&quot;.
- Default is 1000 bp.
- (INTEGER)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-r</span></kbd></td>
<td>Base pairs added downstream (right of) of each entry
in A when searching for overlaps in B.
- Allows one to define assymterical &quot;windows&quot;.
- Default is 1000 bp.
- (INTEGER)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s<var>w</var></span></kbd></td>
<td>Define -l and -r based on strand.  For example if used, -l 500
for a negative-stranded feature will add 500 bp downstream.
- Default = disabled.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s<var>m</var></span></kbd></td>
<td>Only report hits in B that overlap A on the same strand.
- By default, overlaps are reported without respect to strand.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-u</span></kbd></td>
<td>Write the original A entry <strong>once</strong> if <strong>any</strong> overlaps found in B.
- In other words, just report the fact &gt;=1 hit was found.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-c</span></kbd></td>
<td>For each entry in A, report the number of overlaps with B.
- Reports 0 for A entries that have no overlap with B.
- Overlaps restricted by -f.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-v</span></kbd></td>
<td>Only report those entries in A that have <strong>no overlaps</strong> with B.
- Similar to &quot;grep -v.&quot;</td></tr>
</tbody>
</table>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="bedtool-sort">
<h3><a class="reference internal" href="#pybedtools.bedtool.sort" title="pybedtools.bedtool.sort"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.sort</span></tt></a><a class="headerlink" href="#bedtool-sort" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.sort">
<tt class="descclassname">bedtool.</tt><tt class="descname">sort</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.sort" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pybedtools help:</em></p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For convenience, the file this bedtool object points to is passed as &quot;-i&quot;</p>
</div>
</div></blockquote>
<p><em>Original BEDtools program help:</em></p>
<blockquote>
<div><p>Program: sortBed (v2.10.0)
Author:  Aaron Quinlan (<a class="reference external" href="mailto:aaronquinlan&#37;&#52;&#48;gmail&#46;com">aaronquinlan<span>&#64;</span>gmail<span>&#46;</span>com</a>)
Summary: Sorts a feature file in various and useful ways.</p>
<p>Usage:   sortBed [OPTIONS] -i &lt;bed/gff/vcf&gt;</p>
<dl class="docutils">
<dt>Options: </dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-s<var>izeA</var></span></kbd></td>
<td>Sort by feature size in ascending order.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s<var>izeD</var></span></kbd></td>
<td>Sort by feature size in descending order.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-c<var>hrThenSizeA</var></span></kbd></td>
<td>Sort by chrom (asc), then feature size (asc).</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-c<var>hrThenSizeD</var></span></kbd></td>
<td>Sort by chrom (asc), then feature size (desc).</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-c<var>hrThenScoreA</var></span></kbd></td>
<td>Sort by chrom (asc), then score (asc).</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-c<var>hrThenScoreD</var></span></kbd></td>
<td>Sort by chrom (asc), then score (desc).</td></tr>
</tbody>
</table>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="bedtool-slop">
<h3><a class="reference internal" href="#pybedtools.bedtool.slop" title="pybedtools.bedtool.slop"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.slop</span></tt></a><a class="headerlink" href="#bedtool-slop" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.slop">
<tt class="descclassname">bedtool.</tt><tt class="descname">slop</tt><big>(</big><em>genome=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.slop" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pybedtools help:</em></p>
<blockquote>
<div><blockquote>
<div><p>Wraps slopBed, which adds bp to each feature.  Returns a new bedtool
object.</p>
<p>If <em>genome</em> is specified with a genome name, the genome file will be
automatically retrieved from UCSC Genome Browser.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># increase the size of features by 100 bp in either direction</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">slop</span><span class="p">(</span><span class="n">genome</span><span class="o">=</span><span class="s">&#39;dm3&#39;</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c"># grow features by 10 bp upstream and 500 bp downstream,</span>
<span class="c"># using a genome file you already have constructed called</span>
<span class="c"># dm3.genome.</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">slop</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="s">&#39;dm3.genome&#39;</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method returns a new bedtool instance</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For convenience, the file this bedtool object points to is passed as &quot;-i&quot;</p>
</div>
</div></blockquote>
<p><em>Original BEDtools program help:</em></p>
<blockquote>
<div><p>Program: slopBed (v2.10.0)
Author:  Aaron Quinlan (<a class="reference external" href="mailto:aaronquinlan&#37;&#52;&#48;gmail&#46;com">aaronquinlan<span>&#64;</span>gmail<span>&#46;</span>com</a>)
Summary: Add requested base pairs of &quot;slop&quot; to each feature.</p>
<p>Usage:   slopBed [OPTIONS] -i &lt;bed/gff/vcf&gt; -g &lt;genome&gt; [-b &lt;int&gt; or (-l and -r)]</p>
<dl class="docutils">
<dt>Options: </dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-b</span></kbd></td>
<td>Increase the BED/GFF/VCF entry by -b base pairs in each direction.
- (Integer)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-l</span></kbd></td>
<td>The number of base pairs to subtract from the start coordinate.
- (Integer)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-r</span></kbd></td>
<td>The number of base pairs to add to the end coordinate.
- (Integer)</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s</span></kbd></td>
<td>Define -l and -r based on strand.
E.g. if used, -l 500 for a negative-stranded feature, 
it will add 500 bp downstream.  Default = false.</td></tr>
</tbody>
</table>
</dd>
<dt>Notes: </dt>
<dd><ol class="first arabic simple">
<li>Starts will be set to 0 if options would force it below 0.</li>
</ol>
<p>(2)  Ends will be set to the chromosome length if  requested slop would
force it above the max chrom length.
(3)  The genome file should tab delimited and structured as follows:</p>
<p>&lt;chromName&gt;&lt;TAB&gt;&lt;chromSize&gt;</p>
<p class="last">For example, Human (hg19):
chr1    249250621
chr2    243199373
...
chr18**gl000207**random 4262</p>
</dd>
<dt>Tips: </dt>
<dd><p class="first">One can use the UCSC Genome Browser's MySQL database to extract
chromosome sizes. For example, H. sapiens:</p>
<p class="last">mysql --user=genome --host=genome-mysql.cse.ucsc.edu -A -e /
&quot;select chrom, size from hg19.chromInfo&quot;  &gt; hg19.genome</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="bedtool-shuffle">
<h3><a class="reference internal" href="#pybedtools.bedtool.shuffle" title="pybedtools.bedtool.shuffle"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.shuffle</span></tt></a><a class="headerlink" href="#bedtool-shuffle" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.shuffle">
<tt class="descclassname">bedtool.</tt><tt class="descname">shuffle</tt><big>(</big><em>genome=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pybedtools help:</em></p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For convenience, the file this bedtool object points to is passed as &quot;-i&quot;</p>
</div>
</div></blockquote>
<p><em>Original BEDtools program help:</em></p>
<blockquote>
<div><p>Program: shuffleBed (v2.10.0)
Author:  Aaron Quinlan (<a class="reference external" href="mailto:aaronquinlan&#37;&#52;&#48;gmail&#46;com">aaronquinlan<span>&#64;</span>gmail<span>&#46;</span>com</a>)
Summary: Randomly permute the locations of a feature file among a genome.</p>
<p>Usage:   shuffleBed [OPTIONS] -i &lt;bed/gff/vcf&gt; -g &lt;genome&gt;</p>
<dl class="docutils">
<dt>Options: </dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-e<var>xcl</var></span></kbd></td>
<td>A BED/GFF/VCF file of coordinates in which features in -i
should not be placed (e.g. gaps.bed).</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-c<var>hrom</var></span></kbd></td>
<td>Keep features in -i on the same chromosome.
- By default, the chrom and position are randomly chosen.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s<var>eed</var></span></kbd></td>
<td>Supply an integer seed for the shuffling.
- By default, the seed is chosen automatically.
- (INTEGER)</td></tr>
</tbody>
</table>
</dd>
<dt>Notes: </dt>
<dd><ol class="first arabic simple">
<li>The genome file should tab delimited and structured as follows:
&lt;chromName&gt;&lt;TAB&gt;&lt;chromSize&gt;</li>
</ol>
<p class="last">For example, Human (hg19):
chr1    249250621
chr2    243199373
...
chr18**gl000207**random 4262</p>
</dd>
<dt>Tips: </dt>
<dd><p class="first">One can use the UCSC Genome Browser's MySQL database to extract
chromosome sizes. For example, H. sapiens:</p>
<p class="last">mysql --user=genome --host=genome-mysql.cse.ucsc.edu -A -e /
&quot;select chrom, size from hg19.chromInfo&quot;  &gt; hg19.genome</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>
</div>
<div class="section" id="bedtool-methods-unique-to-pybedtools">
<h2><tt class="xref py py-class docutils literal"><span class="pre">bedtool</span></tt> methods unique to <a class="reference internal" href="#module-pybedtools" title="pybedtools"><tt class="xref py py-mod docutils literal"><span class="pre">pybedtools</span></tt></a><a class="headerlink" href="#bedtool-methods-unique-to-pybedtools" title="Permalink to this headline">¶</a></h2>
<p>The following methods are currently only supported for use with BED format
files; support for other file types is under development.</p>
<div class="section" id="bedtool-count">
<h3><a class="reference internal" href="#pybedtools.bedtool.count" title="pybedtools.bedtool.count"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.count</span></tt></a><a class="headerlink" href="#bedtool-count" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.count">
<tt class="descclassname">bedtool.</tt><tt class="descname">count</tt><big>(</big><big>)</big><a class="headerlink" href="#pybedtools.bedtool.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of features in BED file. Does the same thing as len(self), which
actually just calls this method.</p>
<p>Only counts the actual features.  Ignores any track lines, browser
lines, lines starting with a &quot;#&quot;, or blank lines.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-saveas">
<h3><a class="reference internal" href="#pybedtools.bedtool.saveas" title="pybedtools.bedtool.saveas"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.saveas</span></tt></a><a class="headerlink" href="#bedtool-saveas" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.saveas">
<tt class="descclassname">bedtool.</tt><tt class="descname">saveas</tt><big>(</big><em>fn</em>, <em>trackline=None</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.saveas" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Save BED file as a new file, adding the optional <em>trackline</em> to the
beginning.</p>
<p>Returns a new bedtool for the newly saved file.</p>
<p>A newline is automatically added to the trackline if it does not
already have one.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">random_subset</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">saveas</span><span class="p">(</span><span class="s">&#39;random-5.bed&#39;</span><span class="p">,</span><span class="n">trackline</span><span class="o">=</span><span class="s">&#39;track name=&quot;random subset&quot; color=128,128,255&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method returns a new bedtool instance</p>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-get-genome">
<h3><a class="reference internal" href="#pybedtools.bedtool.get_genome" title="pybedtools.bedtool.get_genome"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.get_genome</span></tt></a><a class="headerlink" href="#bedtool-get-genome" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.get_genome">
<tt class="descclassname">bedtool.</tt><tt class="descname">get_genome</tt><big>(</big><em>genome</em>, <em>fn=None</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.get_genome" title="Permalink to this definition">¶</a></dt>
<dd><p>Download chrom size info for <em>genome</em> from UCSC, removes the header
line, and saves in a temp file.  Could be useful for end users,
but mostly called internally by <a class="reference internal" href="#pybedtools.bedtool.slop" title="pybedtools.bedtool.slop"><tt class="xref py py-meth docutils literal"><span class="pre">bedtool.slop()</span></tt></a> and other methods that need
the genome file.</p>
<p>If <em>fn</em> is None, then saves as a temp file.</p>
<p>Returns the filename.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">get_genome</span><span class="p">(</span><span class="s">&#39;dm3&#39;</span><span class="p">,</span> <span class="s">&#39;dm3.genome&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-size-filter">
<h3><a class="reference internal" href="#pybedtools.bedtool.size_filter" title="pybedtools.bedtool.size_filter"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.size_filter</span></tt></a><a class="headerlink" href="#bedtool-size-filter" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.size_filter">
<tt class="descclassname">bedtool.</tt><tt class="descname">size_filter</tt><big>(</big><em>min=0</em>, <em>max=1000000000000000.0</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.size_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new bedtool object containing only those features that are 
&gt; <em>min</em> and &lt; <em>max</em>.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># Only return features that are over 10 bp.</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">size_filter</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-lengths">
<h3><a class="reference internal" href="#pybedtools.bedtool.lengths" title="pybedtools.bedtool.lengths"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.lengths</span></tt></a><a class="headerlink" href="#bedtool-lengths" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.lengths">
<tt class="descclassname">bedtool.</tt><tt class="descname">lengths</tt><big>(</big><big>)</big><a class="headerlink" href="#pybedtools.bedtool.lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of feature lengths.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="n">lengths</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">lengths</span><span class="p">()</span>

<span class="c"># if you have pylab installed, plot a histogram</span>
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-features">
<h3><a class="reference internal" href="#pybedtools.bedtool.features" title="pybedtools.bedtool.features"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.features</span></tt></a><a class="headerlink" href="#bedtool-features" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.features">
<tt class="descclassname">bedtool.</tt><tt class="descname">features</tt><big>(</big><big>)</big><a class="headerlink" href="#pybedtools.bedtool.features" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator of <tt class="xref py py-class docutils literal"><span class="pre">bedfeature</span></tt> objects.</p>
</dd></dl>

</div>
<div class="section" id="bedtool-print-sequence">
<h3><a class="reference internal" href="#pybedtools.bedtool.print_sequence" title="pybedtools.bedtool.print_sequence"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.print_sequence</span></tt></a><a class="headerlink" href="#bedtool-print-sequence" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.print_sequence">
<tt class="descclassname">bedtool.</tt><tt class="descname">print_sequence</tt><big>(</big><big>)</big><a class="headerlink" href="#pybedtools.bedtool.print_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the sequence that was retrieved by the <a class="reference internal" href="#pybedtools.bedtool.sequence" title="pybedtools.bedtool.sequence"><tt class="xref py py-meth docutils literal"><span class="pre">bedtool.sequence()</span></tt></a>
method.</p>
<p>See usage example in <a class="reference internal" href="#pybedtools.bedtool.sequence" title="pybedtools.bedtool.sequence"><tt class="xref py py-meth docutils literal"><span class="pre">bedtool.sequence()</span></tt></a>.</p>
</dd></dl>

</div>
<div class="section" id="bedtool-save-seqs">
<h3><a class="reference internal" href="#pybedtools.bedtool.save_seqs" title="pybedtools.bedtool.save_seqs"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.save_seqs</span></tt></a><a class="headerlink" href="#bedtool-save-seqs" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.save_seqs">
<tt class="descclassname">bedtool.</tt><tt class="descname">save_seqs</tt><big>(</big><em>fn</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.save_seqs" title="Permalink to this definition">¶</a></dt>
<dd><p>Save sequences of features in this bedtool object as a fasta file <em>fn</em>.</p>
<p>In order to use this function, you need to have called
the <a class="reference internal" href="#pybedtools.bedtool.sequence" title="pybedtools.bedtool.sequence"><tt class="xref py py-meth docutils literal"><span class="pre">bedtool.sequence()</span></tt></a> method.</p>
<p>A new bedtool object is returned which references the newly saved file.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># specify the filename of the genome in fasta format</span>
<span class="n">a</span><span class="o">.</span><span class="n">sequence</span><span class="p">(</span><span class="s">&#39;data/genomes/genome.fa&#39;</span><span class="p">)</span>

<span class="c"># use this method to save the seqs that correspond to the features</span>
<span class="c"># in &quot;a&quot;</span>
<span class="n">a</span><span class="o">.</span><span class="n">save_seqs</span><span class="p">(</span><span class="s">&#39;seqs.fa&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-cat">
<h3><a class="reference internal" href="#pybedtools.bedtool.cat" title="pybedtools.bedtool.cat"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.cat</span></tt></a><a class="headerlink" href="#bedtool-cat" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.cat">
<tt class="descclassname">bedtool.</tt><tt class="descname">cat</tt><big>(</big><em>other</em>, <em>postmerge=True</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pybedtools.bedtool.cat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Concatenates two bedtools objects (or an object and a file) and does an
optional post-merge of the features.</p>
<p>Use <em>postmerge=False</em> if you want to keep features separate.</p>
<p>TODO:</p>
<blockquote>
<div>currently truncates at BED3 format!</div></blockquote>
<p>kwargs are sent to <a class="reference internal" href="#pybedtools.bedtool.merge" title="pybedtools.bedtool.merge"><tt class="xref py py-meth docutils literal"><span class="pre">bedtool.merge()</span></tt></a>.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># concatenate and merge features together if they overlap and are</span>
<span class="c"># on the same strand</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="s">&#39;other.bed&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method returns a new bedtool instance</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method accepts either a bedtool or a file name as the first
unnamed argument</p>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-tostring">
<h3><a class="reference internal" href="#pybedtools.bedtool.tostring" title="pybedtools.bedtool.tostring"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.tostring</span></tt></a><a class="headerlink" href="#bedtool-tostring" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.tostring">
<tt class="descclassname">bedtool.</tt><tt class="descname">tostring</tt><big>(</big><big>)</big><a class="headerlink" href="#pybedtools.bedtool.tostring" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the BED file as a string.  You can also <tt class="docutils literal"><span class="pre">print</span></tt> the bedtool object
to view its contents.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># this is one looong string which contains the entire file</span>
<span class="n">long_string</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-sequence-coverage">
<h3><a class="reference internal" href="#pybedtools.bedtool.sequence_coverage" title="pybedtools.bedtool.sequence_coverage"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.sequence_coverage</span></tt></a><a class="headerlink" href="#bedtool-sequence-coverage" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.sequence_coverage">
<tt class="descclassname">bedtool.</tt><tt class="descname">sequence_coverage</tt><big>(</big><big>)</big><a class="headerlink" href="#pybedtools.bedtool.sequence_coverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of bases covered by this BED file.  Does a self.merge() first
to remove potentially multiple-counting bases.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>

<span class="c"># total bp in genome covered by &#39;in.bed&#39;</span>
<span class="n">total_bp</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sequence_coverage</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-counts">
<h3><a class="reference internal" href="#pybedtools.bedtool.counts" title="pybedtools.bedtool.counts"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.counts</span></tt></a><a class="headerlink" href="#bedtool-counts" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.counts">
<tt class="descclassname">bedtool.</tt><tt class="descname">counts</tt><big>(</big><big>)</big><a class="headerlink" href="#pybedtools.bedtool.counts" title="Permalink to this definition">¶</a></dt>
<dd><p>After running <a class="reference internal" href="#pybedtools.bedtool.intersect" title="pybedtools.bedtool.intersect"><tt class="xref py py-meth docutils literal"><span class="pre">bedtool.intersect()</span></tt></a> with the kwarg <em>c=True</em>, use
this method to return a list of the count of features in &quot;b&quot; that
intersected each feature in &quot;a&quot;.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="s">&#39;other.bed&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">counts</span><span class="p">()</span>

<span class="c"># assuming you have matplotlib installed, plot a histogram</span>

<span class="kn">import</span> <span class="nn">pylab</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="bedtool-normalized-counts">
<h3><a class="reference internal" href="#pybedtools.bedtool.normalized_counts" title="pybedtools.bedtool.normalized_counts"><tt class="xref py py-class docutils literal"><span class="pre">bedtool.normalized_counts</span></tt></a><a class="headerlink" href="#bedtool-normalized-counts" title="Permalink to this headline">¶</a></h3>
<dl class="method">
<dt id="pybedtools.bedtool.normalized_counts">
<tt class="descclassname">bedtool.</tt><tt class="descname">normalized_counts</tt><big>(</big><big>)</big><a class="headerlink" href="#pybedtools.bedtool.normalized_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>After running <a class="reference internal" href="#pybedtools.bedtool.intersect" title="pybedtools.bedtool.intersect"><tt class="xref py py-meth docutils literal"><span class="pre">bedtool.intersect()</span></tt></a> with the kwarg <em>c=True</em>, use
this method to return a list of the density of features in &quot;b&quot; that
intersected each feature in &quot;a&quot;.</p>
<p>This takes the counts in each feature and divides by the bp in that
feature.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">bedtool</span><span class="p">(</span><span class="s">&#39;in.bed&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="s">&#39;other.bed&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">normalized_counts</span><span class="p">()</span>

<span class="c"># assuming you have matplotlib installed, plot a histogram</span>

<span class="kn">import</span> <span class="nn">pylab</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Module documentation</a><ul>
<li><a class="reference internal" href="#module-pybedtools"><tt class="docutils literal"><span class="pre">pybedtools</span></tt> module-level functions</a></li>
<li><a class="reference internal" href="#bedtool-methods-that-wrap-bedtools-programs"><tt class="docutils literal"><span class="pre">bedtool</span></tt> methods that wrap BEDTools programs</a><ul>
<li><a class="reference internal" href="#bedtool-intersect"><tt class="docutils literal"><span class="pre">bedtool.intersect</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-merge"><tt class="docutils literal"><span class="pre">bedtool.merge</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-subtract"><tt class="docutils literal"><span class="pre">bedtool.subtract</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-sequence"><tt class="docutils literal"><span class="pre">bedtool.sequence</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-closest"><tt class="docutils literal"><span class="pre">bedtool.closest</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-window"><tt class="docutils literal"><span class="pre">bedtool.window</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-sort"><tt class="docutils literal"><span class="pre">bedtool.sort</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-slop"><tt class="docutils literal"><span class="pre">bedtool.slop</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-shuffle"><tt class="docutils literal"><span class="pre">bedtool.shuffle</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#bedtool-methods-unique-to-pybedtools"><tt class="docutils literal"><span class="pre">bedtool</span></tt> methods unique to <tt class="docutils literal"><span class="pre">pybedtools</span></tt></a><ul>
<li><a class="reference internal" href="#bedtool-count"><tt class="docutils literal"><span class="pre">bedtool.count</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-saveas"><tt class="docutils literal"><span class="pre">bedtool.saveas</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-get-genome"><tt class="docutils literal"><span class="pre">bedtool.get_genome</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-size-filter"><tt class="docutils literal"><span class="pre">bedtool.size_filter</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-lengths"><tt class="docutils literal"><span class="pre">bedtool.lengths</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-features"><tt class="docutils literal"><span class="pre">bedtool.features</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-print-sequence"><tt class="docutils literal"><span class="pre">bedtool.print_sequence</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-save-seqs"><tt class="docutils literal"><span class="pre">bedtool.save_seqs</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-cat"><tt class="docutils literal"><span class="pre">bedtool.cat</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-tostring"><tt class="docutils literal"><span class="pre">bedtool.tostring</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-sequence-coverage"><tt class="docutils literal"><span class="pre">bedtool.sequence_coverage</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-counts"><tt class="docutils literal"><span class="pre">bedtool.counts</span></tt></a></li>
<li><a class="reference internal" href="#bedtool-normalized-counts"><tt class="docutils literal"><span class="pre">bedtool.normalized_counts</span></tt></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tutorial.html"
                        title="previous chapter">Tutorial</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/autodoc_source.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             >previous</a> |</li>
        <li><a href="index.html">pybedtools v0.2.2dev documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Ryan Dale.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>